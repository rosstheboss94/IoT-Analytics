from adls.adls import AzureDataLake

test_data = ["{'topic': 'fluid', 'partition': 0, 'offset': 5506, 'timestamp': 1692020138011, 'key': None, 'value': 50.900001525878906, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5507, 'timestamp': 1692020139126, 'key': None, 'value': 49.5099983215332, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5508, 'timestamp': 1692020140243, 'key': None, 'value': 48.09000015258789, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5509, 'timestamp': 1692020141358, 'key': None, 'value': 46.83000183105469, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5510, 'timestamp': 1692020142507, 'key': None, 'value': 47.63999938964844, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5511, 'timestamp': 1692020143621, 'key': None, 'value': 48.849998474121094, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5512, 'timestamp': 1692020144737, 'key': None, 'value': 49.18000030517578, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5513, 'timestamp': 1692020145852, 'key': None, 'value': 47.31999969482422, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5514, 'timestamp': 1692020146967, 'key': None, 'value': 45.36000061035156, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5515, 'timestamp': 1692020148080, 'key': None, 'value': 43.939998626708984, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5516, 'timestamp': 1692020149194, 'key': None, 'value': 44.900001525878906, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5517, 'timestamp': 1692020150310, 'key': None, 'value': 43.45000076293945, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5518, 'timestamp': 1692020151424, 'key': None, 'value': 44.61000061035156, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5519, 'timestamp': 1692020152537, 'key': None, 'value': 45.43000030517578, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5520, 'timestamp': 1692020153650, 'key': None, 'value': 46.97999954223633, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5521, 'timestamp': 1692020154762, 'key': None, 'value': 46.470001220703125, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5522, 'timestamp': 1692020155877, 'key': None, 'value': 46.689998626708984, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5523, 'timestamp': 1692020156993, 'key': None, 'value': 46.0, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5524, 'timestamp': 1692020158106, 'key': None, 'value': 47.59000015258789, 'headers': []}", "{'topic': 'fluid', 'partition': 0, 'offset': 5525, 'timestamp': 1692020159222, 'key': None, 'value': 47.04999923706055, 'headers': []}"]

sas = '?sv=2022-11-02&ss=bfqt&srt=sco&sp=rwlacupx&se=2024-08-13T12:18:04Z&st=2023-08-13T04:18:04Z&spr=https&sig=zgIyaOIIgS%2F8M6FYGmOY6eBJeDcaOJ6LgE9gNemWgSM%3D'
dl = AzureDataLake('iotanalytics1994', sas)
file_system = dl.create_file_system('testfilesystem2')
directory = dl.create_directory(file_system, 'd1')
#dl.upload_json_file_to_directory(directory, 'test2.json', [str({'name': 'bob', 'age': 20}), str({'name': 'bill', 'age': 30})])
dl.upload_json_file_to_directory(directory, 'test2.json', test_data)

print(''.join(sorted('adbc')))